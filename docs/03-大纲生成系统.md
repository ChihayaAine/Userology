# è®¿è°ˆå¤§çº²ç”Ÿæˆç³»ç»Ÿ

> **ç‰ˆæœ¬**: 1.4.5
> **æœ€åæ›´æ–°**: 2025-10-31
> **é‡è¦æ›´æ–°**: ä¸¤æ­¥å¤§çº²ç”Ÿæˆç³»ç»Ÿ + Session Depth Level ç³»ç»Ÿ

---

## ğŸ“– ç³»ç»Ÿæ¦‚è¿°

è®¿è°ˆå¤§çº²ç”Ÿæˆç³»ç»Ÿæ˜¯ Userology çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œè´Ÿè´£æ ¹æ®ç ”ç©¶ç›®æ ‡è‡ªåŠ¨ç”Ÿæˆé«˜è´¨é‡çš„è®¿è°ˆå¤§çº²ã€‚ç³»ç»Ÿæ”¯æŒä¸¤ç§æ¨¡å¼ï¼š

1. **æ ‡å‡†é—®é¢˜æ¨¡å¼** (Lisa/Bob)ï¼šç”Ÿæˆå›ºå®šé—®é¢˜åˆ—è¡¨ï¼ˆä¼ ç»Ÿæ¨¡å¼ï¼‰
2. **ä¸¤æ­¥å¤§çº²ç”Ÿæˆæ¨¡å¼** (David)ï¼šç”Ÿæˆå¯ç¼–è¾‘çš„ Session éª¨æ¶ â†’ ç”Ÿæˆå®Œæ•´å¤§çº²ï¼ˆ**æ¨è**ï¼‰

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### ä¸¤æ­¥å¤§çº²ç”Ÿæˆæµç¨‹ï¼ˆv1.4.0+ï¼‰

```
ç”¨æˆ·è¾“å…¥ç ”ç©¶ç›®æ ‡
    â†“
Step 1: ç”Ÿæˆéª¨æ¶
    â†“
AI ç”Ÿæˆ Session æ¡†æ¶
ï¼ˆä¸»é¢˜ã€ç›®æ ‡ã€èƒŒæ™¯ä¿¡æ¯ã€æ·±åº¦ç­‰çº§ï¼‰
    â†“
Step 2: ç”¨æˆ· Review & ç¼–è¾‘
    â†“
ç”¨æˆ·ç¼–è¾‘éª¨æ¶
ï¼ˆè°ƒæ•´ä¸»é¢˜ã€æ·»åŠ å¿…é—®é—®é¢˜ã€è°ƒæ•´æ·±åº¦ç­‰çº§ï¼‰
    â†“
Step 3: ç”Ÿæˆå®Œæ•´å¤§çº²
    â†“
AI åŸºäºéª¨æ¶ç”Ÿæˆå…·ä½“é—®é¢˜
ï¼ˆ4-6 ä¸ªé—®é¢˜ + å¤šå±‚æ¬¡è¿½é—®ç­–ç•¥ï¼‰
    â†“
å®Œæ•´è®¿è°ˆå¤§çº²
```

### æŠ€æœ¯æ ˆ

- **AI æ¨¡å‹**: OpenAI GPT-4o
- **API ä»£ç†**: tu-zi.com
- **Prompt å·¥ç¨‹**: ä¸¤é˜¶æ®µ Promptï¼ˆéª¨æ¶ç”Ÿæˆ + å®Œæ•´å¤§çº²ç”Ÿæˆï¼‰
- **è¾“å‡ºæ ¼å¼**: JSON (ç»“æ„åŒ–æ•°æ®)
- **çŠ¶æ€ç®¡ç†**: Zustand Storeï¼ˆå‰ç«¯éª¨æ¶ç¼–è¾‘ï¼‰

---

## ğŸ¯ åŠŸèƒ½æ¨¡å¼

### æ¨¡å¼ 1: ä¸¤æ­¥å¤§çº²ç”Ÿæˆï¼ˆæ¨èï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- æ·±åº¦ç”¨æˆ·ç ”ç©¶
- éœ€æ±‚æ¢ç´¢
- äº§å“è°ƒç ”
- éœ€è¦ç²¾ç¡®æ§åˆ¶è®¿è°ˆæµç¨‹çš„åœºæ™¯

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- âœ… ç”¨æˆ·å¯é¢„è®¾ Session ä¸»é¢˜
- âœ… ç”¨æˆ·å¯æ·»åŠ å¿…é—®é—®é¢˜
- âœ… ç”¨æˆ·å¯è°ƒæ•´ Session æ·±åº¦ç­‰çº§
- âœ… AI å’Œç”¨æˆ·åä½œç”Ÿæˆå¤§çº²
- âœ… ç”Ÿæˆç»“æœå¯æ§ã€å¯é¢„æµ‹

---

#### Step 1: ç”Ÿæˆéª¨æ¶

**API ç«¯ç‚¹**ï¼š
```
POST /api/outlines/skeleton
```

**è¯·æ±‚å‚æ•°**ï¼š
```typescript
{
  name: string;              // ç ”ç©¶åç§°
  objective: string;         // ç ”ç©¶ç›®æ ‡
  context: string;           // ä¸Šä¸‹æ–‡
  session_count: number;     // Session æ•°é‡
  duration_minutes: number;  // è®¿è°ˆæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
  draft_language: string;    // åˆç¨¿è¯­è¨€ï¼ˆå¦‚ 'zh-CN', 'en-US'ï¼‰
  researchType: 'market' | 'product'; // ç ”ç©¶ç±»å‹
  manualSessions?: Array<{   // ç”¨æˆ·é¢„è®¾çš„ Session ä¸»é¢˜ï¼ˆå¯é€‰ï¼‰
    session_number: number;
    theme: string;
  }>;
}
```

**å“åº”æ ¼å¼**ï¼š
```typescript
{
  skeleton: {
    sessions: Array<{
      session_number: number;
      session_title: string;
      session_goal: string;
      background_information: string[];
      must_ask_questions: string[];
      depth_level: 'high' | 'medium' | 'low';
      ai_suggested_depth_level: 'high' | 'medium' | 'low';
    }>;
    metadata: {
      total_sessions: number;
      estimated_duration_minutes: number;
      draft_language: string;
    };
  };
  status: 'skeleton_generated';
}
```

**Prompt æ–‡ä»¶**ï¼š
- `backend/src/lib/prompts/generate-outline-skeleton.ts`

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **Session ä¸»é¢˜ç”Ÿæˆ**ï¼šAI æ ¹æ®ç ”ç©¶ç›®æ ‡ç”Ÿæˆ Session ä¸»é¢˜
2. **ç”¨æˆ·ä¸»é¢˜éµå¾ª**ï¼šå¦‚æœç”¨æˆ·é¢„è®¾äº† Session ä¸»é¢˜ï¼ŒAI ä¸¥æ ¼éµå¾ª
3. **èƒŒæ™¯ä¿¡æ¯ç”Ÿæˆ**ï¼šä¸ºæ¯ä¸ª Session ç”Ÿæˆ 5-8 æ¡å…·ä½“ã€å¯æ“ä½œçš„èƒŒæ™¯ä¿¡æ¯
4. **æ·±åº¦ç­‰çº§åˆ†é…**ï¼šAI è‡ªåŠ¨åˆ¤æ–­æ¯ä¸ª Session çš„æ·±åº¦ç­‰çº§ï¼ˆhigh/medium/lowï¼‰

---

#### Step 2: ç”¨æˆ· Review & ç¼–è¾‘

**å‰ç«¯ç»„ä»¶**ï¼š
- `frontend/src/components/dashboard/interview/create-popup/SessionCard.tsx`

**å¯ç¼–è¾‘å†…å®¹**ï¼š
1. **Session æ ‡é¢˜**ï¼šä¿®æ”¹ AI ç”Ÿæˆçš„æ ‡é¢˜
2. **Session ç›®æ ‡**ï¼šè°ƒæ•´ Session çš„ç›®æ ‡æè¿°
3. **èƒŒæ™¯ä¿¡æ¯**ï¼šæ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤èƒŒæ™¯ä¿¡æ¯
4. **å¿…é—®é—®é¢˜**ï¼šæ·»åŠ ç”¨æˆ·æŒ‡å®šçš„å¿…é—®é—®é¢˜
5. **æ·±åº¦ç­‰çº§**ï¼šè°ƒæ•´ Session çš„æ·±åº¦ç­‰çº§ï¼ˆhigh/medium/lowï¼‰

**API ç«¯ç‚¹**ï¼š
```
PATCH /api/outlines/:id/skeleton
```

**è¯·æ±‚å‚æ•°**ï¼š
```typescript
{
  skeleton: OutlineSkeleton; // æ›´æ–°åçš„éª¨æ¶
}
```

---

#### Step 3: ç”Ÿæˆå®Œæ•´å¤§çº²

**API ç«¯ç‚¹**ï¼š
```
POST /api/outlines/:id/full-outline
```

**å“åº”æ ¼å¼**ï¼š
```typescript
{
  draft_outline: Array<{
    session_text: string;    // å®Œæ•´çš„ Session æ–‡æœ¬ï¼ˆMarkdown æ ¼å¼ï¼‰
    depth_level: 'high' | 'medium' | 'low';
  }>;
  description: string;       // ç ”ç©¶æè¿°ï¼ˆ50 å­—ä»¥å†…ï¼‰
}
```

**Prompt æ–‡ä»¶**ï¼š
- `backend/src/lib/prompts/generate-full-outline-from-skeleton.ts`

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **é—®é¢˜æ•°é‡åˆ†é…**ï¼šæ ¹æ® depth_level åˆ†é…é—®é¢˜æ•°é‡
   - high: 5-6 ä¸ªé—®é¢˜
   - medium: 4-5 ä¸ªé—®é¢˜
   - low: 2-4 ä¸ªé—®é¢˜
2. **å¤šå±‚æ¬¡è¿½é—®ç­–ç•¥**ï¼šä¸ºå…³é”®é—®é¢˜ç”Ÿæˆ L1â†’L2â†’L3 è¿½é—®
3. **å¿…é—®é—®é¢˜èå…¥**ï¼šå°†ç”¨æˆ·æŒ‡å®šçš„å¿…é—®é—®é¢˜è‡ªç„¶èå…¥è®¿è°ˆæµç¨‹
4. **Session Opening**ï¼šä¸ºç¬¬ä¸€ä¸ª Session ç”Ÿæˆ 6 å…ƒç´ å¼€åœºç™½
5. **ç»“æŸæç¤º**ï¼šåœ¨æœ€åä¸€ä¸ª Session æ·»åŠ "ç‚¹å‡»ç»“æŸè®¿è°ˆæŒ‰é’®"æç¤º

---

### æ¨¡å¼ 2: æ ‡å‡†é—®é¢˜ç”Ÿæˆï¼ˆä¼ ç»Ÿæ¨¡å¼ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- å¿«é€Ÿç”¨æˆ·è°ƒç ”
- æ ‡å‡†åŒ–è®¿è°ˆæµç¨‹
- éœ€è¦å›ºå®šé—®é¢˜åˆ—è¡¨çš„åœºæ™¯

**API ç«¯ç‚¹**ï¼š
```
POST /api/generate-interview-questions
POST /api/generate-interview-sessions
```

**è¯´æ˜**ï¼šæ­¤æ¨¡å¼ä¸ºå‘åå…¼å®¹ä¿ç•™ï¼Œæ¨èä½¿ç”¨ä¸¤æ­¥å¤§çº²ç”Ÿæˆæ¨¡å¼ã€‚

---

## ğŸ¯ Session Depth Level ç³»ç»Ÿï¼ˆv1.4.2+ï¼‰

### æ ¸å¿ƒæ¦‚å¿µ

Session Depth Levelï¼ˆä¼šè¯æ·±åº¦ç­‰çº§ï¼‰æ˜¯ä¸€ä¸ªç”¨äºæ§åˆ¶è®¿è°ˆ Session é‡è¦æ€§å’Œæ·±åº¦çš„ç³»ç»Ÿã€‚å®ƒå½±å“ï¼š
- é—®é¢˜æ•°é‡
- è¿½é—®æ·±åº¦
- æ—¶é—´åˆ†é…
- AI ä¼˜å…ˆçº§

### ä¸‰ä¸ªæ·±åº¦ç­‰çº§

| ç­‰çº§ | é—®é¢˜æ•°é‡ | è¿½é—®æ·±åº¦ | æ—¶é—´åˆ†é… | é€‚ç”¨åœºæ™¯ |
|------|---------|---------|---------|---------|
| **High** | 5-6 ä¸ª | 3-4 å±‚ (L1â†’L2â†’L3) | 8-10 åˆ†é’Ÿ | æ ¸å¿ƒç›®æ ‡ã€ç—›ç‚¹åˆ†æã€ç«å“ç ”ç©¶ã€åŠŸèƒ½éªŒè¯ |
| **Medium** | 4-5 ä¸ª | 2-3 å±‚ | 6-8 åˆ†é’Ÿ | ä¸Šä¸‹æ–‡æ„å»ºã€è¡Œä¸ºæ¢ç´¢ã€ä¸€èˆ¬ä½“éªŒ |
| **Low** | 2-4 ä¸ª | 1-2 å±‚ | 4-5 åˆ†é’Ÿ | æš–åœºã€æ”¶å°¾ |

### AI åˆ¤æ–­é€»è¾‘

AI åœ¨ç”Ÿæˆéª¨æ¶æ—¶ï¼Œä¼šæ ¹æ®ä»¥ä¸‹è§„åˆ™è‡ªåŠ¨åˆ†é… depth_levelï¼š

1. **åˆ†æç ”ç©¶ç›®æ ‡**ï¼šè¯†åˆ«å“ªäº› Session ç›´æ¥è§£å†³æ ¸å¿ƒç ”ç©¶é—®é¢˜
2. **é—®é¢˜ç±»å‹åˆ¤æ–­**ï¼š
   - æ¢ç´¢"why"ã€"pain points"ã€"alternatives"çš„ Session â†’ **high**
   - æ¢ç´¢"what"ã€"how"ã€"when"çš„ Session â†’ **medium**
   - ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ª Session é€šå¸¸ â†’ **low**ï¼ˆé™¤éç ”ç©¶ä¸“æ³¨äº onboarding/offboardingï¼‰
3. **å…¸å‹åˆ†é…**ï¼š2-3 high, 2-3 medium, 1-2 low

### ç”¨æˆ·è°ƒæ•´

ç”¨æˆ·å¯ä»¥åœ¨éª¨æ¶ review ç•Œé¢æ‰‹åŠ¨è°ƒæ•´æ¯ä¸ª Session çš„ depth_levelï¼š

**UI è®¾è®¡**ï¼š
- ä¸‰ä¸ªæŒ‰é’®ï¼šLow (2-4 Qs) / Medium (4-5 Qs) / High (5-6 Qs)
- é¢œè‰²ç¼–ç ï¼šç°è‰²ï¼ˆLowï¼‰/ è“è‰²ï¼ˆMediumï¼‰/ ç´«è‰²ï¼ˆHighï¼‰
- æ˜¾ç¤º AI å»ºè®®ï¼š"(AI suggested: high)"
- ä¿¡æ¯æŒ‰é’®ï¼ˆâ„¹ï¸ï¼‰å±•å¼€è¯¦ç»†è¯´æ˜

**æ•°æ®ç»“æ„**ï¼š
```typescript
export type SessionDepthLevel = 'high' | 'medium' | 'low';

export interface SkeletonSession {
  session_number: number;
  session_title: string;
  session_goal: string;
  background_information: string[];
  must_ask_questions: string[];
  depth_level: SessionDepthLevel;           // å½“å‰è®¾ç½®
  ai_suggested_depth_level: SessionDepthLevel; // AI å»ºè®®ï¼ˆä¸å˜ï¼‰
}
```

### å½±å“ç»´åº¦

#### 1. é—®é¢˜æ•°é‡

ç”Ÿæˆå®Œæ•´å¤§çº²æ—¶ï¼Œä¸¥æ ¼æŒ‰ç…§ depth_level åˆ†é…é—®é¢˜æ•°é‡ï¼š

```typescript
// Prompt ä¸­çš„é€»è¾‘
if (depth_level === 'high') {
  // ç”Ÿæˆ 5-6 ä¸ªé—®é¢˜
} else if (depth_level === 'medium') {
  // ç”Ÿæˆ 4-5 ä¸ªé—®é¢˜
} else {
  // ç”Ÿæˆ 2-4 ä¸ªé—®é¢˜
}
```

#### 2. è¿½é—®æ·±åº¦

**High Depth Level**:
```
Q1.1 [Main Question]
  L1: [Initial clarification]
  L2: [If L1 reveals Y] â†’ [Specific example]
  L3: [If L2 reveals Z] â†’ [Impact/root cause]
```

**Medium Depth Level**:
```
Q1.1 [Main Question]
  L1: [Initial clarification]
  L2: [If L1 reveals Y] â†’ [Specific example]
```

**Low Depth Level**:
```
Q1.1 [Main Question]
  L1: [Basic follow-up if needed]
```

#### 3. æ—¶é—´åˆ†é…ï¼ˆä¼ é€’åˆ° Retell AIï¼‰

åœ¨è®¿è°ˆæ‰§è¡Œæ—¶ï¼Œdepth_level ä¼šä¼ é€’åˆ° Retell AI çš„ç³»ç»Ÿæç¤ºè¯ï¼š

```typescript
// backend/src/controllers/call.controller.ts
const dynamicVariables = {
  depth_level_1: session1.depth_level,
  depth_level_2: session2.depth_level,
  // ...
};
```

Retell AI ä¼šæ ¹æ® depth_level è°ƒæ•´æ—¶é—´åˆ†é…ï¼š
- **high**: 8-10 åˆ†é’Ÿï¼Œæ·±åº¦è¿½é—®
- **medium**: 6-8 åˆ†é’Ÿï¼Œæ ‡å‡†è¿½é—®
- **low**: 4-5 åˆ†é’Ÿï¼Œç®€æ´é«˜æ•ˆ

#### 4. AI ä¼˜å…ˆçº§

åœ¨ç”Ÿæˆå®Œæ•´å¤§çº²æ—¶ï¼ŒAI ä¼šä¼˜å…ˆä¸º high depth level çš„ Session ç”Ÿæˆï¼š
- æ›´è¯¦ç»†çš„ Interviewer Notes
- æ›´å…·ä½“çš„ Background Information å¼•ç”¨
- æ›´æ·±å…¥çš„è¿½é—®ç­–ç•¥

---

## ğŸ”§ å¤šå±‚æ¬¡è¿½é—®ç­–ç•¥ï¼ˆv1.4.1+ï¼‰

### è®¾è®¡ç†å¿µ

**é—®é¢˜èƒŒæ™¯**ï¼š
- ä¼ ç»Ÿè¿½é—®åªæœ‰ä¸€å±‚ï¼Œæ— æ³•æ·±æŒ–å…³é”®ä¿¡æ¯
- ä¾‹å¦‚ï¼šç”¨æˆ·æåˆ°"ä½¿ç”¨ä¸ä¾¿"ï¼Œè¿½é—®åå¾—åˆ°"æ— æ³•åœ¨å­¦æ ¡ä½¿ç”¨"ï¼Œä½†æ²¡æœ‰ç»§ç»­è¿½é—®"ä¸ºä»€ä¹ˆ"

**è§£å†³æ–¹æ¡ˆ**ï¼š
è®¾è®¡åˆ†å±‚è¿½é—®æœºåˆ¶ï¼ˆL1 â†’ L2 â†’ L3ï¼‰ï¼Œä»è¡¨é¢å›ç­”æ·±æŒ–åˆ°å¯æ‰§è¡Œæ´å¯Ÿ

### ä¸‰å±‚è¿½é—®

#### L1 (Surface Exploration)
**ç›®æ ‡**ï¼šæ¾„æ¸…æ¨¡ç³Šé™ˆè¿°ï¼Œè·å–åˆæ­¥ç»†èŠ‚

**ç¤ºä¾‹**ï¼š
- "What makes it inconvenient?"
- "Why can't it be used at school?"
- "What do you mean by 'not user-friendly'?"

#### L2 (Concrete Examples)
**ç›®æ ‡**ï¼šè¯·æ±‚å…·ä½“åœºæ™¯ï¼Œæ­ç¤ºçœŸå®è¡Œä¸º

**ç¤ºä¾‹**ï¼š
- "Can you walk me through a specific time when this happened?"
- "What exactly did you do when you encountered this issue?"
- "Can you describe the last time you used this feature?"

#### L3 (Impact & Root Cause)
**ç›®æ ‡**ï¼šç†è§£åæœï¼Œè¯†åˆ«æ½œåœ¨éœ€æ±‚

**ç¤ºä¾‹**ï¼š
- "How did that affect your study plan?"
- "What would an ideal solution look like?"
- "What did you do instead?"

### åº”ç”¨åœºæ™¯

å¤šå±‚æ¬¡è¿½é—®ä¸»è¦åº”ç”¨äºï¼š
- ç—›ç‚¹åˆ†æ
- ç«å“åˆ†æ
- åŠŸèƒ½éªŒè¯
- éœ€æ±‚æ¢ç´¢

### Prompt å®ç°

```markdown
**Follow-up Directions (Multi-Level):**
[If user mentions X] â†’
  L1: [Initial clarification]
  L2: [If L1 reveals Y] â†’ [Specific example]
  L3: [If L2 reveals Z] â†’ [Impact/root cause]
**Skip if:** [Conditions]
```

---

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### æ–°å¢å­—æ®µï¼ˆv1.4.0ï¼‰

```sql
-- interview è¡¨
ALTER TABLE interview ADD COLUMN outline_skeleton JSONB;
ALTER TABLE interview ADD COLUMN outline_generation_status VARCHAR(50);
ALTER TABLE interview ADD COLUMN skeleton_generated_at TIMESTAMP WITH TIME ZONE;
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `outline_skeleton` | JSONB | å­˜å‚¨éª¨æ¶æ•°æ®ï¼ˆsessions + metadataï¼‰ |
| `outline_generation_status` | VARCHAR | ç”ŸæˆçŠ¶æ€ï¼ˆ'skeleton_generated', 'full_outline_generated'ï¼‰ |
| `skeleton_generated_at` | TIMESTAMP | éª¨æ¶ç”Ÿæˆæ—¶é—´ |
| `draft_outline` | JSONB | å®Œæ•´å¤§çº²ï¼ˆArray<{session_text, depth_level}>ï¼‰ |
| `outline_debug_language` | TEXT | åˆç¨¿è¯­è¨€ä»£ç ï¼ˆå¦‚ 'zh-CN'ï¼‰ |

### æ•°æ®æµå‘

```
1. ç”Ÿæˆéª¨æ¶ â†’ outline_skeleton (åŒ…å« metadata.draft_language)
2. ç”¨æˆ·ç¼–è¾‘ â†’ æ›´æ–° outline_skeleton
3. ç”Ÿæˆå®Œæ•´å¤§çº² â†’ draft_outline (åŒ…å« depth_level)
4. æœ¬åœ°åŒ–ï¼ˆå¯é€‰ï¼‰â†’ localized_outline
5. ä¿å­˜ â†’ questions = localized_outline || draft_outline
```

---

## ğŸ”§ å®ç°ç»†èŠ‚

### Controller å±‚

**æ–‡ä»¶**: `backend/src/controllers/questions.controller.ts`

**æ ¸å¿ƒå‡½æ•°**ï¼š

#### 1. `generateOutlineSkeleton` (v1.4.0+)

ç”Ÿæˆéª¨æ¶ï¼ˆStep 1ï¼‰

```typescript
export const generateOutlineSkeleton = async (req: Request, res: Response) => {
  const {
    name,
    objective,
    context,
    session_count,
    duration_minutes,
    draft_language,
    researchType,
    manualSessions
  } = req.body;

  // 1. è°ƒç”¨éª¨æ¶ç”Ÿæˆ Prompt
  const completion = await openaiClient.chat.completions.create({
    model: "gpt-4o",
    temperature: 0.7,
    messages: [
      { role: "system", content: SYSTEM_PROMPT_SKELETON },
      { role: "user", content: generateSkeletonPrompt({
        objective,
        context,
        session_count,
        duration_minutes,
        language: draft_language,
        researchType,
        manualSessions
      })}
    ],
    response_format: { type: "json_object" }
  });

  // 2. è§£æéª¨æ¶
  const skeleton = JSON.parse(completion.choices[0].message?.content);

  // 3. ä¸ºæ¯ä¸ª session æ·»åŠ  ai_suggested_depth_level
  skeleton.sessions = skeleton.sessions.map(session => ({
    ...session,
    ai_suggested_depth_level: session.depth_level || 'medium'
  }));

  // 4. ç¡®ä¿ metadata.draft_language å­˜åœ¨
  if (!skeleton.metadata) skeleton.metadata = {};
  if (!skeleton.metadata.draft_language) {
    skeleton.metadata.draft_language = draft_language;
  }

  res.status(200).json({ skeleton, status: 'skeleton_generated' });
};
```

#### 2. `updateOutlineSkeleton` (v1.4.0+)

æ›´æ–°éª¨æ¶ï¼ˆStep 2ï¼‰

```typescript
export const updateOutlineSkeleton = async (req: Request, res: Response) => {
  const { id } = req.params;
  const { skeleton } = req.body;

  // æ›´æ–° interview çš„ outline_skeleton å­—æ®µ
  await InterviewService.updateInterview({
    outline_skeleton: skeleton
  }, id);

  res.status(200).json({ skeleton, status: 'skeleton_generated' });
};
```

#### 3. `generateFullOutlineFromSkeleton` (v1.4.0+)

ç”Ÿæˆå®Œæ•´å¤§çº²ï¼ˆStep 3ï¼‰

```typescript
export const generateFullOutlineFromSkeleton = async (req: Request, res: Response) => {
  const { id } = req.params;

  // 1. è·å– interview å’Œ skeleton
  const interview = await InterviewService.getInterviewById(id);
  const skeleton = interview.outline_skeleton;

  // 2. è°ƒç”¨å®Œæ•´å¤§çº²ç”Ÿæˆ Prompt
  const completion = await openaiClient.chat.completions.create({
    model: "gpt-4o",
    temperature: 0.7,
    messages: [
      { role: "system", content: SYSTEM_PROMPT_FULL_OUTLINE },
      { role: "user", content: generateFullOutlinePrompt({
        skeleton,
        objective: interview.objective,
        context: interview.context,
        researchType: interview.researchType
      })}
    ],
    response_format: { type: "json_object" }
  });

  // 3. è§£æå®Œæ•´å¤§çº²
  const result = JSON.parse(completion.choices[0].message?.content);

  // 4. ä¿å­˜åˆ°æ•°æ®åº“
  await InterviewService.updateInterview({
    draft_outline: result.questions,
    description: result.description,
    outline_generation_status: 'full_outline_generated'
  }, id);

  res.status(200).json(result);
};
```

---

## ğŸ“ Prompt å·¥ç¨‹

### Prompt æ–‡ä»¶ç»“æ„

**éª¨æ¶ç”Ÿæˆ**:
- `backend/src/lib/prompts/generate-outline-skeleton.ts`
  - `SYSTEM_PROMPT_SKELETON`: System Prompt
  - `generateSkeletonPrompt()`: User Prompt ç”Ÿæˆå‡½æ•°

**å®Œæ•´å¤§çº²ç”Ÿæˆ**:
- `backend/src/lib/prompts/generate-full-outline-from-skeleton.ts`
  - `SYSTEM_PROMPT_FULL_OUTLINE_PRODUCT`: äº§å“è°ƒç ” System Prompt
  - `SYSTEM_PROMPT_FULL_OUTLINE_MARKET`: å¸‚åœºè°ƒç ” System Prompt
  - `generateFullOutlinePrompt()`: User Prompt ç”Ÿæˆå‡½æ•°

### éª¨æ¶ç”Ÿæˆ Prompt è®¾è®¡

#### System Prompt

```typescript
export const SYSTEM_PROMPT_SKELETON =
  "You are a world-class research expert and interview structure designer. " +
  "Your specialty is creating well-structured interview session frameworks " +
  "with SPECIFIC, ACTIONABLE background information.";
```

#### User Prompt æ ¸å¿ƒéƒ¨åˆ†

1. **ç ”ç©¶ç›®æ ‡å’Œä¸Šä¸‹æ–‡**
2. **Session æ•°é‡å’Œæ—¶é•¿**
3. **ç”¨æˆ·é¢„è®¾çš„ Session ä¸»é¢˜**ï¼ˆå¦‚æœæœ‰ï¼‰
4. **Session Depth Level Assignment**ï¼ˆAI åˆ¤æ–­é€»è¾‘ï¼‰
5. **Background Information Requirements**ï¼ˆ5-8 æ¡ï¼Œå¤šè§†è§’ã€æ·±åº¦åœºæ™¯åŒ–ï¼‰
6. **Output Format**ï¼ˆåŒ…å« depth_level å­—æ®µï¼‰
7. **Quality Checklist**

**å…³é”®éƒ¨åˆ†ç¤ºä¾‹**:

```markdown
## Session Depth Level Assignment

Analyze the research objective and assign a depth level to each session:

- **high**: Sessions that directly address core research questions
  - Exploring "why", "pain points", "alternatives"
  - Competitive analysis, feature validation
  - Typically: 2-3 sessions

- **medium**: Sessions that provide necessary context
  - Exploring "what", "how", "when"
  - Background building, behavior exploration
  - Typically: 2-3 sessions

- **low**: Sessions for warm-up or wrap-up
  - First and last sessions (unless research focuses on onboarding/offboarding)
  - Typically: 1-2 sessions
```

### å®Œæ•´å¤§çº²ç”Ÿæˆ Prompt è®¾è®¡

#### System Prompt

```typescript
export const SYSTEM_PROMPT_FULL_OUTLINE_PRODUCT =
  "You are a world-class user research expert specializing in product research interviews. " +
  "Your specialty is creating in-depth, open-ended interview questions with multi-level follow-up strategies.";
```

#### User Prompt æ ¸å¿ƒéƒ¨åˆ†

1. **ç ”ç©¶ç›®æ ‡å’Œä¸Šä¸‹æ–‡**
2. **Skeleton Summary**ï¼ˆæ˜¾ç¤ºæ¯ä¸ª Session çš„ depth_levelï¼‰
3. **Your Task**ï¼ˆç”Ÿæˆå®Œæ•´å¤§çº²çš„è¦æ±‚ï¼‰
4. **Question Depth and Quantity Requirements**ï¼ˆæ ¹æ® depth_level åˆ†é…é—®é¢˜æ•°é‡ï¼‰
5. **Multi-Level Follow-up Strategy**ï¼ˆL1â†’L2â†’L3ï¼‰
6. **Output Format**ï¼ˆåŒ…å« session_text å’Œ depth_levelï¼‰
7. **Quality Checklist**

**å…³é”®éƒ¨åˆ†ç¤ºä¾‹**:

```markdown
## Question Depth and Quantity Requirements

STRICTLY follow the `depth_level` from the skeleton:

- **high** (5-6 questions):
  - Deep reference to Study Objective
  - Fully utilize Background Information
  - Multi-level follow-ups (L1â†’L2â†’L3)

- **medium** (4-5 questions):
  - Moderate reference to Study Objective
  - Basic follow-ups (L1â†’L2)

- **low** (2-4 questions):
  - Simple conversation
  - Minimal follow-ups (L1 only)
```

### Temperature è®¾ç½®

- **éª¨æ¶ç”Ÿæˆ**: 0.7ï¼ˆéœ€è¦åˆ›é€ æ€§ï¼Œç”Ÿæˆå¤šæ ·åŒ–çš„ Session ä¸»é¢˜ï¼‰
- **å®Œæ•´å¤§çº²ç”Ÿæˆ**: 0.7ï¼ˆéœ€è¦è‡ªç„¶è¡¨è¾¾ï¼Œç”Ÿæˆæµç•…çš„é—®é¢˜ï¼‰

### è¾“å‡ºæ ¼å¼

**éª¨æ¶ç”Ÿæˆ**:
```json
{
  "sessions": [
    {
      "session_number": 1,
      "session_title": "...",
      "session_goal": "...",
      "background_information": ["...", "..."],
      "must_ask_questions": [],
      "depth_level": "high"
    }
  ],
  "metadata": {
    "total_sessions": 6,
    "estimated_duration_minutes": 60,
    "draft_language": "zh-CN"
  }
}
```

**å®Œæ•´å¤§çº²ç”Ÿæˆ**:
```json
{
  "questions": [
    {
      "session_text": "### **Session 1: ...**\n\n...",
      "depth_level": "high"
    }
  ],
  "description": "50-word description"
}
```

---

## ğŸŒ å¤šè¯­è¨€æ”¯æŒ

### è¯­è¨€å‚æ•°

- `draft_language`: åˆç¨¿è¯­è¨€ï¼ˆéª¨æ¶å’Œå®Œæ•´å¤§çº²ç”Ÿæˆæ—¶ä½¿ç”¨ï¼‰
- `language`: è®¿è°ˆè¯­è¨€ï¼ˆæœ€ç»ˆè®¿è°ˆä½¿ç”¨çš„è¯­è¨€ï¼Œå¯é€šè¿‡æœ¬åœ°åŒ–è½¬æ¢ï¼‰

### è¯­è¨€æµç¨‹

```
1. ç”¨æˆ·é€‰æ‹© draft_languageï¼ˆå¦‚ 'zh-CN'ï¼‰
2. ç”Ÿæˆéª¨æ¶ â†’ skeleton.metadata.draft_language = 'zh-CN'
3. ç”Ÿæˆå®Œæ•´å¤§çº² â†’ ä½¿ç”¨ skeleton.metadata.draft_language
4. ï¼ˆå¯é€‰ï¼‰æœ¬åœ°åŒ– â†’ è½¬æ¢ä¸º languageï¼ˆå¦‚ 'en-US'ï¼‰
```

### æ”¯æŒçš„è¯­è¨€

- `zh-CN`: ç®€ä½“ä¸­æ–‡
- `zh-TW`: ç¹ä½“ä¸­æ–‡
- `en-US`: è‹±è¯­
- `ja-JP`: æ—¥è¯­
- `fr-FR`: æ³•è¯­
- `de-DE`: å¾·è¯­
- `es-ES`: è¥¿ç­ç‰™è¯­
- `ko-KR`: éŸ©è¯­

### è¯­è¨€ä¸€è‡´æ€§ä¿è¯ï¼ˆv1.4.5ï¼‰

**é—®é¢˜**ï¼šç”¨æˆ·é‡æ–°ç”Ÿæˆéª¨æ¶ï¼ˆæ”¹å˜è¯­è¨€ï¼‰åï¼Œç”Ÿæˆçš„åˆç¨¿ä¾ç„¶ä½¿ç”¨æ—§è¯­è¨€

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **åç«¯**ï¼šç¡®ä¿ `skeleton.metadata.draft_language` å­˜åœ¨ï¼ˆå¦‚æœ AI æ²¡ç”Ÿæˆï¼Œæ‰‹åŠ¨æ·»åŠ ï¼‰
2. **å‰ç«¯**ï¼šå½“ `interviewId` å·²å­˜åœ¨æ—¶ï¼Œå…ˆæ›´æ–° skeleton å†ç”Ÿæˆå®Œæ•´å¤§çº²

---

## ğŸ”„ ä¸å¤§çº²æœ¬åœ°åŒ–çš„é›†æˆ

ç”Ÿæˆçš„å¤§çº²å¯ä»¥é€šè¿‡å¤§çº²æœ¬åœ°åŒ–åŠŸèƒ½è¿›è¡Œè¯­è¨€è½¬æ¢ï¼š

```
1. ä½¿ç”¨ outline_debug_language ç”Ÿæˆåˆç¨¿
   â†“
2. ç ”ç©¶è€…å®¡æ ¸å’Œè°ƒæ•´
   â†“
3. è°ƒç”¨ /api/localize-outline æœ¬åœ°åŒ–åˆ°ç›®æ ‡è¯­è¨€
   â†“
4. ç”Ÿæˆæœ€ç»ˆè®¿è°ˆå¤§çº²
```

è¯¦è§ï¼š[å¤§çº²æœ¬åœ°åŒ–åŠŸèƒ½æ–‡æ¡£](./03-å¤§çº²æœ¬åœ°åŒ–åŠŸèƒ½.md)

---

## ğŸ¨ å‰ç«¯é›†æˆ

### ä¸¤æ­¥å¤§çº²ç”Ÿæˆæµç¨‹ï¼ˆv1.4.0+ï¼‰

**ä¸»æ–‡ä»¶**: `frontend/src/components/dashboard/interview/create-popup/questions.tsx`

**æµç¨‹**ï¼š

1. **ç”¨æˆ·é…ç½®**ï¼š
   - å¡«å†™ç ”ç©¶ä¿¡æ¯ï¼ˆname, objective, contextï¼‰
   - é€‰æ‹© Session æ•°é‡å’Œæ—¶é•¿
   - é€‰æ‹©åˆç¨¿è¯­è¨€ï¼ˆdraft_languageï¼‰
   - ï¼ˆå¯é€‰ï¼‰é¢„è®¾ Session ä¸»é¢˜

2. **ç”Ÿæˆéª¨æ¶**ï¼š
   - ç‚¹å‡»"ç”Ÿæˆéª¨æ¶"æŒ‰é’®
   - è°ƒç”¨ `POST /api/outlines/skeleton`
   - æ˜¾ç¤ºéª¨æ¶ review ç•Œé¢

3. **ç¼–è¾‘éª¨æ¶**ï¼š
   - ä½¿ç”¨ `SessionCard` ç»„ä»¶ç¼–è¾‘æ¯ä¸ª Session
   - è°ƒæ•´ Session æ ‡é¢˜ã€ç›®æ ‡ã€èƒŒæ™¯ä¿¡æ¯
   - æ·»åŠ å¿…é—®é—®é¢˜
   - è°ƒæ•´æ·±åº¦ç­‰çº§ï¼ˆdepth_levelï¼‰
   - å®æ—¶ä¿å­˜åˆ° Zustand Store

4. **ç”Ÿæˆå®Œæ•´å¤§çº²**ï¼š
   - ç‚¹å‡»"ç”Ÿæˆå®Œæ•´å¤§çº²"æŒ‰é’®
   - å¦‚æœ `interviewId` å·²å­˜åœ¨ï¼Œå…ˆè°ƒç”¨ `PATCH /api/outlines/:id/skeleton` æ›´æ–°éª¨æ¶
   - è°ƒç”¨ `POST /api/outlines/:id/full-outline`
   - æ˜¾ç¤ºç”Ÿæˆçš„å®Œæ•´å¤§çº²

### æ ¸å¿ƒç»„ä»¶

#### 1. SessionCard ç»„ä»¶

**æ–‡ä»¶**: `frontend/src/components/dashboard/interview/create-popup/SessionCard.tsx`

**åŠŸèƒ½**ï¼š
- æ˜¾ç¤ºå’Œç¼–è¾‘ Session ä¿¡æ¯
- Depth Level é€‰æ‹©å™¨ï¼ˆLow/Medium/Highï¼‰
- èƒŒæ™¯ä¿¡æ¯ç¼–è¾‘ï¼ˆæ·»åŠ ã€åˆ é™¤ï¼‰
- å¿…é—®é—®é¢˜ç¼–è¾‘ï¼ˆæ·»åŠ ã€åˆ é™¤ï¼‰

**å…³é”®ä»£ç **ï¼š

```typescript
const SessionCard = ({ session, onUpdate }) => {
  const [localSession, setLocalSession] = useState(session);

  const handleDepthLevelChange = (newLevel: SessionDepthLevel) => {
    const updated = { ...localSession, depth_level: newLevel };
    setLocalSession(updated);
    onUpdate(updated);
  };

  return (
    <div className="session-card">
      {/* Session æ ‡é¢˜å’Œç›®æ ‡ */}
      <input value={localSession.session_title} onChange={...} />
      <textarea value={localSession.session_goal} onChange={...} />

      {/* Depth Level é€‰æ‹©å™¨ */}
      <div className="depth-level-selector">
        <button onClick={() => handleDepthLevelChange('low')}>
          Low (2-4 Qs)
        </button>
        <button onClick={() => handleDepthLevelChange('medium')}>
          Medium (4-5 Qs)
        </button>
        <button onClick={() => handleDepthLevelChange('high')}>
          High (5-6 Qs)
        </button>
      </div>

      {/* èƒŒæ™¯ä¿¡æ¯å’Œå¿…é—®é—®é¢˜ */}
      {/* ... */}
    </div>
  );
};
```

#### 2. éª¨æ¶ç”Ÿæˆé€»è¾‘

```typescript
const onGenerateSkeleton = async () => {
  setIsGeneratingSkeleton(true);

  try {
    // å‡†å¤‡ç”¨æˆ·é¢„è®¾çš„ Session ä¸»é¢˜
    const filledManualSessions = manualSessions
      .filter(s => s.content.trim())
      .map((s, idx) => ({
        session_number: idx + 1,
        theme: s.content.trim()
      }));

    // ç”Ÿæˆéª¨æ¶
    const result = await OutlineService.generateSkeleton({
      name: interviewData.name,
      objective: interviewData.objective,
      context: interviewData.context,
      session_count: Number(numQuestions),
      duration_minutes: Number(duration),
      draft_language: localOutlineDebugLanguage,
      researchType: researchType,
      manualSessions: filledManualSessions.length > 0 ? filledManualSessions : undefined
    });

    setSkeleton(result.skeleton);
    setShowSkeletonReview(true);
  } catch (error) {
    console.error('âŒ Error generating skeleton:', error);
  } finally {
    setIsGeneratingSkeleton(false);
  }
};
```

#### 3. å®Œæ•´å¤§çº²ç”Ÿæˆé€»è¾‘

```typescript
const onConfirmSkeletonAndGenerateFullOutline = async () => {
  if (!skeleton) return;

  setIsGeneratingFullOutline(true);

  try {
    // å¦‚æœè¿˜æ²¡æœ‰ interviewIdï¼Œå…ˆåˆ›å»º interview
    let currentInterviewId = interviewId;
    if (!currentInterviewId) {
      const createResponse = await apiClient.post("/interviews", {
        organizationName: organization?.name,
        interviewData: {
          ...interviewData,
          outline_skeleton: skeleton,
          outline_debug_language: localOutlineDebugLanguage
        }
      });
      currentInterviewId = createResponse.data.id;
      setInterviewId(currentInterviewId);
    } else {
      // å¦‚æœ interviewId å·²å­˜åœ¨ï¼Œå…ˆæ›´æ–° skeleton
      await OutlineService.updateSkeleton(currentInterviewId, skeleton);
    }

    // ç”Ÿæˆå®Œæ•´å¤§çº²
    const result = await OutlineService.generateFullOutline(currentInterviewId);

    // è§£æç”Ÿæˆçš„é—®é¢˜
    const generatedQuestions = result.draft_outline.map((item, index) => ({
      id: uuidv4(),
      question: item.session_text,
      follow_up_count: 1,
      depth_level: item.depth_level || 'medium'
    }));

    setDraftQuestions(generatedQuestions);
    setInterviewData({
      ...interviewData,
      questions: generatedQuestions,
      description: result.description
    });

    setShowSkeletonReview(false);
  } catch (error) {
    console.error('âŒ Error generating full outline:', error);
  } finally {
    setIsGeneratingFullOutline(false);
  }
};
```

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### è¶…æ—¶è®¾ç½®

- **éª¨æ¶ç”Ÿæˆ**: 120ç§’
- **å®Œæ•´å¤§çº²ç”Ÿæˆ**: 120ç§’

### é”™è¯¯å¤„ç†

```typescript
try {
  // ç”Ÿæˆéª¨æ¶æˆ–å®Œæ•´å¤§çº²...
} catch (error) {
  if (error.code === 'ECONNABORTED') {
    // è¶…æ—¶é”™è¯¯
    toast.error('ç”Ÿæˆè¶…æ—¶ï¼Œè¯·é‡è¯•');
  } else if (error.response?.status === 429) {
    // API é…é¢é™åˆ¶
    toast.error('API é…é¢å·²ç”¨å®Œï¼Œè¯·ç¨åé‡è¯•');
  } else if (error.response?.status === 403) {
    // ä½™é¢ä¸è¶³
    toast.error('API ä½™é¢ä¸è¶³ï¼Œè¯·å……å€¼');
  } else {
    // å…¶ä»–é”™è¯¯
    toast.error('ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•');
  }
}
```

---

## ğŸ“Š æ•°æ®æµ

### ä¸¤æ­¥å¤§çº²ç”Ÿæˆæ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥ï¼ˆç ”ç©¶ç›®æ ‡ã€Session æ•°é‡ã€è¯­è¨€ï¼‰
  â†“
å‰ç«¯éªŒè¯
  â†“
API è¯·æ±‚ (POST /api/outlines/skeleton)
  â†“
Controller æ¥æ”¶å‚æ•°
  â†“
æ„å»ºéª¨æ¶ç”Ÿæˆ Prompt
  â†“
è°ƒç”¨ OpenAI GPT-4o
  â†“
è§£æ JSON å“åº”ï¼ˆskeletonï¼‰
  â†“
æ·»åŠ  ai_suggested_depth_level
  â†“
ç¡®ä¿ metadata.draft_language å­˜åœ¨
  â†“
è¿”å›å‰ç«¯
  â†“
æ˜¾ç¤ºéª¨æ¶ review ç•Œé¢
  â†“
ç”¨æˆ·ç¼–è¾‘éª¨æ¶ï¼ˆè°ƒæ•´ depth_levelã€æ·»åŠ å¿…é—®é—®é¢˜ï¼‰
  â†“
ä¿å­˜åˆ° Zustand Store
  â†“
ç”¨æˆ·ç‚¹å‡»"ç”Ÿæˆå®Œæ•´å¤§çº²"
  â†“
API è¯·æ±‚ (PATCH /api/outlines/:id/skeleton) - æ›´æ–°éª¨æ¶
  â†“
API è¯·æ±‚ (POST /api/outlines/:id/full-outline)
  â†“
Controller è¯»å– skeleton
  â†“
æ„å»ºå®Œæ•´å¤§çº²ç”Ÿæˆ Prompt
  â†“
è°ƒç”¨ OpenAI GPT-4o
  â†“
è§£æ JSON å“åº”ï¼ˆdraft_outlineï¼‰
  â†“
ä¿å­˜åˆ°æ•°æ®åº“ï¼ˆdraft_outline, descriptionï¼‰
  â†“
è¿”å›å‰ç«¯
  â†“
æ˜¾ç¤ºå®Œæ•´å¤§çº²
  â†“
ç”¨æˆ·ç¼–è¾‘å’Œä¿å­˜
```

---

## ğŸ” è°ƒè¯•å’Œæ—¥å¿—

### å…³é”®æ—¥å¿—ç‚¹

**éª¨æ¶ç”Ÿæˆ**:
```typescript
console.log('ğŸš€ Generating skeleton with data:', {
  session_count,
  draft_language,
  manualSessions
});
console.log('âœ… Skeleton generated successfully:', {
  total_sessions: skeleton.metadata?.total_sessions,
  draft_language: skeleton.metadata?.draft_language
});
```

**å®Œæ•´å¤§çº²ç”Ÿæˆ**:
```typescript
console.log('ğŸ“ Generating full outline from skeleton:', {
  total_sessions: skeleton.metadata.total_sessions,
  draft_language: skeleton.metadata.draft_language
});
console.log('âœ… Full outline generated successfully:', {
  question_count: result.draft_outline.length
});
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. Session ä¸»é¢˜é¢„è®¾

**æ¨èåšæ³•**ï¼š
- å¯¹äºæ˜ç¡®çš„ç ”ç©¶ç›®æ ‡ï¼Œé¢„è®¾ Session ä¸»é¢˜å¯ä»¥æé«˜ç”Ÿæˆè´¨é‡
- ä¾‹å¦‚ï¼šäº§å“è°ƒç ” â†’ "äº§å“å‘ç°"ã€"ä½¿ç”¨ä½“éªŒ"ã€"ç—›ç‚¹åˆ†æ"ã€"ç«å“å¯¹æ¯”"

**ä¸æ¨èåšæ³•**ï¼š
- é¢„è®¾è¿‡äºå®½æ³›çš„ä¸»é¢˜ï¼ˆå¦‚"äº†è§£ç”¨æˆ·"ï¼‰
- é¢„è®¾è¿‡äºå…·ä½“çš„é—®é¢˜ï¼ˆåº”è¯¥åœ¨"å¿…é—®é—®é¢˜"ä¸­æ·»åŠ ï¼‰

### 2. Depth Level è°ƒæ•´

**æ¨èåšæ³•**ï¼š
- ä¿¡ä»» AI çš„å»ºè®®ï¼Œåªåœ¨å¿…è¦æ—¶è°ƒæ•´
- ç¡®ä¿è‡³å°‘æœ‰ 2-3 ä¸ª high depth level çš„ Session
- ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ª Session é€šå¸¸è®¾ä¸º low

**ä¸æ¨èåšæ³•**ï¼š
- æ‰€æœ‰ Session éƒ½è®¾ä¸º highï¼ˆä¼šå¯¼è‡´è®¿è°ˆè¿‡é•¿ï¼‰
- æ ¸å¿ƒ Session è®¾ä¸º lowï¼ˆä¼šå¯¼è‡´ä¿¡æ¯ä¸è¶³ï¼‰

### 3. å¿…é—®é—®é¢˜æ·»åŠ 

**æ¨èåšæ³•**ï¼š
- æ·»åŠ å…³é”®çš„éªŒè¯æ€§é—®é¢˜ï¼ˆå¦‚"ä½ ä¼šæ¨èç»™æœ‹å‹å—ï¼Ÿ"ï¼‰
- æ·»åŠ ç‰¹å®šçš„äº§å“åŠŸèƒ½éªŒè¯é—®é¢˜
- ä¿æŒç®€æ´ï¼ˆæ¯ä¸ª Session 1-2 ä¸ªå¿…é—®é—®é¢˜ï¼‰

**ä¸æ¨èåšæ³•**ï¼š
- æ·»åŠ è¿‡å¤šå¿…é—®é—®é¢˜ï¼ˆä¼šé™åˆ¶ AI çš„çµæ´»æ€§ï¼‰
- æ·»åŠ è¿‡äºå¼€æ”¾çš„é—®é¢˜ï¼ˆåº”è¯¥è®© AI ç”Ÿæˆï¼‰

### 4. èƒŒæ™¯ä¿¡æ¯ç¼–è¾‘

**æ¨èåšæ³•**ï¼š
- ä¿ç•™ AI ç”Ÿæˆçš„å¤šè§†è§’èƒŒæ™¯ä¿¡æ¯
- æ·»åŠ ç‰¹å®šçš„äº§å“ä¿¡æ¯æˆ–ç«å“ä¿¡æ¯
- ç¡®ä¿èƒŒæ™¯ä¿¡æ¯å…·ä½“ã€å¯æ“ä½œ

**ä¸æ¨èåšæ³•**ï¼š
- åˆ é™¤æ‰€æœ‰ AI ç”Ÿæˆçš„èƒŒæ™¯ä¿¡æ¯
- æ·»åŠ è¿‡äºå®½æ³›çš„èƒŒæ™¯ä¿¡æ¯

---

## ğŸ› å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### é—®é¢˜ 1: AI åªç”Ÿæˆé¦–å°¾ Sessionï¼ˆå·²ä¿®å¤ v1.4.5ï¼‰

**ç°è±¡**: åˆ›å»º 6 ä¸ª sessionsï¼Œåªç”Ÿæˆ session 1 å’Œ session 6

**åŸå› **: Prompt çš„è¾“å‡ºæ ¼å¼ç¤ºä¾‹åªæ˜¾ç¤ºäº† Session 1 å’Œæœ€åä¸€ä¸ª Session

**è§£å†³æ–¹æ¡ˆ**:
- åœ¨ Prompt ä¸­æ·»åŠ  "CRITICAL: You MUST generate EXACTLY N sessions" è­¦å‘Š
- æ·»åŠ  Session 2 ç¤ºä¾‹

### é—®é¢˜ 2: é‡æ–°ç”Ÿæˆåˆç¨¿æ—¶è¯­è¨€ä¸æ›´æ–°ï¼ˆå·²ä¿®å¤ v1.4.5ï¼‰

**ç°è±¡**: é‡æ–°ç”Ÿæˆéª¨æ¶ï¼ˆæ”¹å˜è¯­è¨€ï¼‰åï¼Œåˆç¨¿ä¾ç„¶ä½¿ç”¨æ—§è¯­è¨€

**åŸå› **: å‰ç«¯æ²¡æœ‰æ›´æ–°æ•°æ®åº“ä¸­çš„ skeleton

**è§£å†³æ–¹æ¡ˆ**:
- å‰ç«¯ï¼šå½“ `interviewId` å·²å­˜åœ¨æ—¶ï¼Œå…ˆè°ƒç”¨ `updateSkeleton` å†ç”Ÿæˆå®Œæ•´å¤§çº²
- åç«¯ï¼šç¡®ä¿ `skeleton.metadata.draft_language` å­˜åœ¨

### é—®é¢˜ 3: API ä½™é¢ä¸è¶³

**ç°è±¡**: é”™è¯¯ä¿¡æ¯ "é¢„æ‰£è´¹é¢åº¦å¤±è´¥, ç”¨æˆ·å‰©ä½™é¢åº¦: $X, éœ€è¦é¢„æ‰£è´¹é¢åº¦: $Y"

**åŸå› **: tu-zi.com API è´¦æˆ·ä½™é¢ä¸è¶³

**è§£å†³æ–¹æ¡ˆ**:
- ç™»å½• https://tu-zi.com å……å€¼
- å»ºè®®å……å€¼ $5-10ï¼Œé¿å…é¢‘ç¹å……å€¼

### é—®é¢˜ 4: ç”Ÿæˆçš„é—®é¢˜æ•°é‡ä¸ç¬¦åˆ depth_level

**ç°è±¡**: high depth level çš„ Session åªç”Ÿæˆäº† 3 ä¸ªé—®é¢˜

**åŸå› **: Prompt ä¸­çš„è¦æ±‚ä¸å¤Ÿæ˜ç¡®

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ Prompt ä¸­çš„ "Question Depth and Quantity Requirements" éƒ¨åˆ†
- ç¡®ä¿ä½¿ç”¨ "STRICTLY follow the `depth_level`" ç­‰å¼ºè°ƒæ€§è¯­è¨€

### é—®é¢˜ 5: å¿…é—®é—®é¢˜æ²¡æœ‰è¢«èå…¥

**ç°è±¡**: ç”¨æˆ·æ·»åŠ çš„å¿…é—®é—®é¢˜æ²¡æœ‰å‡ºç°åœ¨å®Œæ•´å¤§çº²ä¸­

**åŸå› **: Prompt ä¸­æ²¡æœ‰æ­£ç¡®ä¼ é€’ `must_ask_questions`

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ `generateFullOutlinePrompt` å‡½æ•°
- ç¡®ä¿ skeleton ä¸­çš„ `must_ask_questions` è¢«æ­£ç¡®ä¼ é€’åˆ° Prompt
   - å¢åŠ è¶…æ—¶æ—¶é—´

---

## ï¿½ ç‰ˆæœ¬å†å²

### v1.4.5 (2025-10-31)
- ğŸ› ä¿®å¤ AI åªç”Ÿæˆé¦–å°¾ session çš„é—®é¢˜
- ğŸ› ä¿®å¤é‡æ–°ç”Ÿæˆåˆç¨¿æ—¶è¯­è¨€ä¸æ›´æ–°çš„é—®é¢˜
- ğŸ“ æ·»åŠ è¯¦ç»†è°ƒè¯•æ—¥å¿—

### v1.4.4 (2025-10-30)
- ğŸ¨ éª¨æ¶ç”Ÿæˆ Context æ·±åº¦å¼ºåŒ–
- ğŸ› ä¿®å¤ AI suggested depth level æ˜¾ç¤ºé—®é¢˜

### v1.4.3 (2025-10-30)
- ğŸ¨ Depth Level è¯­ä¹‰å¢å¼º
- ğŸ”§ æ•°æ®ç»“æ„ä¼˜åŒ–

### v1.4.2 (2025-10-30)
- ğŸš€ Session Depth Level ç³»ç»Ÿå®ç°
- ğŸ¨ Depth Level é€‰æ‹©å™¨ UI

### v1.4.1 (2025-10-30)
- ğŸš€ å¤šå±‚æ¬¡è¿½é—®ç­–ç•¥ï¼ˆL1â†’L2â†’L3ï¼‰
- ğŸš€ æ™ºèƒ½é—®é¢˜æ•°é‡åˆ†é…

### v1.4.0 (2025-10-30)
- ğŸš€ ä¸¤æ­¥å¤§çº²ç”Ÿæˆç³»ç»Ÿå®Œæ•´å®ç°
- ğŸš€ Session é…ç½®ä¼ å¯¼
- ğŸš€ å¿…é—®é—®é¢˜åŠŸèƒ½
- ğŸ“Š æ•°æ®åº“å­—æ®µæ·»åŠ ï¼ˆoutline_skeleton, outline_generation_statusï¼‰

### v1.3.8 (2025-10-26)
- ğŸ¯ è¿½é—®ç”Ÿæˆé€»è¾‘ä¼˜åŒ–ï¼ˆæ–¹å‘æ€§æŒ‡ç¤ºã€Session æŠ½è±¡åŒ–ï¼‰

### v1.3.7 (2025-10-25)
- ğŸ¨ æ·±åº¦è®¿è°ˆ Prompt ä¼˜åŒ–ï¼ˆå¼€æ”¾æ€§é—®é¢˜ã€Study Objective å¿…é—®é¡¹ï¼‰

### v1.3.6 (2025-10-24)
- ğŸ”§ æ™ºèƒ½è¡¥å…¨æœºåˆ¶ï¼ˆå·²åºŸå¼ƒï¼Œv1.4.0+ ä½¿ç”¨æ–°æµç¨‹ï¼‰

---

## ï¿½ğŸ”§ æ—§ç‰ˆæœ¬åŠŸèƒ½ï¼ˆv1.3.xï¼‰

ä»¥ä¸‹åŠŸèƒ½åœ¨ v1.4.0 ä¹‹å‰ä½¿ç”¨ï¼Œç°å·²è¢«ä¸¤æ­¥å¤§çº²ç”Ÿæˆç³»ç»Ÿå–ä»£ï¼š

### æ™ºèƒ½è¡¥å…¨æœºåˆ¶ (v1.3.6)

### é—®é¢˜èƒŒæ™¯

åœ¨æ·±åº¦è®¿è°ˆæ¨¡å¼ï¼ˆDavidï¼‰ä¸­ï¼ŒGPT æœ‰æ—¶ä¼šç”Ÿæˆé”™è¯¯æ•°é‡çš„ Sessionsï¼š
- ç”¨æˆ·è¯·æ±‚ 10 ä¸ª Sessionsï¼ŒGPT å¯èƒ½åªç”Ÿæˆ 8 ä¸ª
- ç”¨æˆ·è¯·æ±‚ 5 ä¸ª Sessionsï¼ŒGPT å¯èƒ½ç”Ÿæˆ 6 ä¸ª

### è§£å†³æ–¹æ¡ˆ

**ä¸‰å±‚ä¿éšœæœºåˆ¶**ï¼š

#### 1. Prompt å¼ºåŒ–ï¼ˆé¢„é˜²ï¼‰

åœ¨ User Prompt ä¸­æ·»åŠ ä¸¥æ ¼çš„æ•°é‡è¦æ±‚ï¼š

```typescript
âš ï¸ **STRICT SESSION COUNT REQUIREMENT** âš ï¸:
You MUST generate EXACTLY ${requestedCount} sessions - no more, no less.
- âŒ Do NOT generate ${requestedCount + 1} sessions
- âŒ Do NOT generate ${requestedCount - 1} sessions
- âœ… Generate EXACTLY ${requestedCount} complete sessions
- If you generate the wrong number, the system will malfunction
```

#### 2. æ™ºèƒ½è¡¥å…¨ï¼ˆä¿®å¤ï¼‰

å¦‚æœ GPT ç”Ÿæˆçš„æ•°é‡ä¸è¶³ï¼Œè‡ªåŠ¨è°ƒç”¨ GPT è¡¥å…¨ï¼š

```typescript
// æ£€æµ‹æ•°é‡ä¸åŒ¹é…
if (actualCount < requestedCount) {
  const missing = requestedCount - actualCount;

  // è°ƒç”¨ GPT è¡¥å…¨å‰©ä½™ Sessions
  const complementPrompt = `
    You previously generated ${actualCount} sessions.
    Now generate EXACTLY ${missing} MORE sessions.
    Continue from Session ${actualCount + 1} to Session ${requestedCount}.
  `;

  // åˆå¹¶åŸå§‹å’Œè¡¥å…¨çš„ Sessions
  allSessions = [...originalSessions, ...complementSessions];
}
```

#### 3. æ™ºèƒ½æˆªæ–­ï¼ˆä¿®å¤ï¼‰

å¦‚æœ GPT ç”Ÿæˆçš„æ•°é‡è¿‡å¤šï¼Œè‡ªåŠ¨æˆªæ–­ï¼š

```typescript
if (actualCount > requestedCount) {
  sessions = sessions.slice(0, requestedCount);
}
```

### æŠ€æœ¯å®ç°

**ä½ç½®**: `backend/src/controllers/questions.controller.ts`

**æ ¸å¿ƒé€»è¾‘**ï¼š

```typescript
// 1. éªŒè¯ç”Ÿæˆçš„æ•°é‡
const actualCount = parsedContent.questions?.length || 0;
const requestedCount = Math.min(body.number, 10);

// 2. è®°å½•è¯¦ç»†æ—¥å¿—
console.log('ğŸ“Š Session Count Verification:', {
  requested: requestedCount,
  actualGenerated: actualCount,
  match: actualCount === requestedCount ? 'âœ…' : 'âŒ'
});

// 3. æ™ºèƒ½è¡¥å…¨æˆ–æˆªæ–­
if (actualCount < requestedCount) {
  // è°ƒç”¨ GPT è¡¥å…¨
  const complementResponse = await openaiClient.chat.completions.create({...});
  parsedContent.questions = [...original, ...complement];
} else if (actualCount > requestedCount) {
  // æˆªæ–­å¤šä½™çš„
  parsedContent.questions = parsedContent.questions.slice(0, requestedCount);
}
```

### æ•ˆæœ

- âœ… **å‡†ç¡®æ€§**: 100% ä¿è¯ç”Ÿæˆæ­£ç¡®æ•°é‡çš„ Sessions
- âœ… **è´¨é‡**: è¡¥å…¨çš„ Sessions ä¸åŸå§‹ Sessions è´¨é‡ä¸€è‡´
- âœ… **è¿è´¯æ€§**: è¡¥å…¨çš„ Sessions è‡ªç„¶è¡”æ¥åŸå§‹å†…å®¹
- âœ… **å¯è¿½æº¯**: è¯¦ç»†çš„æ—¥å¿—è®°å½•ï¼Œä¾¿äºè°ƒè¯•

### ç›¸å…³ Prompt æ›´æ–°

**æ–‡ä»¶**:
- `backend/src/lib/prompts/generate-sessions.ts`
- `backend/src/lib/prompts/generate-market-research-sessions.ts`
- `backend/src/lib/prompts/generate-product-research-sessions.ts`

**æ›´æ–°å†…å®¹**: æ·»åŠ ä¸¥æ ¼çš„æ•°é‡è¦æ±‚è­¦å‘Š

---

## ğŸ¨ æ·±åº¦è®¿è°ˆ Prompt ä¼˜åŒ– (v1.3.7)

### ä¼˜åŒ–ç›®æ ‡

é’ˆå¯¹æ·±åº¦è®¿è°ˆæ¨¡å¼ï¼ˆDavidï¼‰çš„ Prompt è¿›è¡Œå…¨é¢ä¼˜åŒ–ï¼Œæå‡ç”Ÿæˆçš„è®¿è°ˆå¤§çº²è´¨é‡ï¼š

1. **å¼ºåŒ–å¼€æ”¾æ€§é—®é¢˜è®¾è®¡åŸåˆ™**
2. **æ·»åŠ  Study Objective å¿…é—®é¡¹è¯†åˆ«é€»è¾‘**
3. **ä¼˜åŒ–è¿½é—®è®¾è®¡ç­–ç•¥**ï¼ˆå…³é”®é—®é¢˜ vs å³å…´è¿½é—®ï¼‰
4. **æ¸…ç†æœ¬åœ°åŒ–ç›¸å…³å†…å®¹**ï¼ˆå·²æ‹†åˆ†åˆ°ç‹¬ç«‹å‡½æ•°ï¼‰

### 1. å¼€æ”¾æ€§é—®é¢˜è®¾è®¡åŸåˆ™ ğŸ¯

**æ ¸å¿ƒç†å¿µ**: è®©å‚ä¸è€…å®šä¹‰è‡ªå·±çš„ä½“éªŒï¼Œä¸é¢„è®¾ç«‹åœºæˆ–å‡è®¾ã€‚

#### âŒ é¿å…çš„é—®é¢˜ç±»å‹

**å¼•å¯¼æ€§é—®é¢˜**ï¼ˆå‡è®¾é—®é¢˜å­˜åœ¨ï¼‰:
```
âŒ "How difficult is it to manage your tasks?"
âŒ "How often do you struggle with [task]?"
âŒ "What challenges do you face when..."
```

**æš—ç¤ºæ€§é—®é¢˜**ï¼ˆå‡è®¾éœ€æ±‚å­˜åœ¨ï¼‰:
```
âŒ "What features would you like to see?"
âŒ "What improvements would you suggest?"
âŒ "Don't you think X would be helpful?"
```

**å‡è®¾æ€§é—®é¢˜**ï¼ˆå‡è®¾ä½“éªŒæ˜¯æ­£é¢æˆ–è´Ÿé¢çš„ï¼‰:
```
âŒ "What do you like about [Feature]?"
âŒ "How useful is [Feature]?"
âŒ "What frustrates you about..."
```

#### âœ… æ¨èçš„é—®é¢˜ç±»å‹

**è¡Œä¸ºæ¢ç´¢é—®é¢˜**:
```
âœ… "Tell me about how you currently manage your tasks."
âœ… "Walk me through your typical workflow for [scenario]."
âœ… "Can you describe a recent time when you [did X]?"
```

**ä½“éªŒæè¿°é—®é¢˜**:
```
âœ… "What's your experience been like with [topic]?"
âœ… "How does [Product] fit into your daily routine?"
âœ… "Tell me about your experience using [Feature]."
```

**å…·ä½“æ¡ˆä¾‹é—®é¢˜**:
```
âœ… "Can you walk me through a specific recent example?"
âœ… "What happened the last time you [did X]?"
âœ… "Tell me about a time when..."
```

#### å…³é”®åŸåˆ™

1. **èšç„¦è¡Œä¸º**ï¼šé—®äººä»¬åšä»€ä¹ˆï¼Œè€Œéæƒ³ä»€ä¹ˆ
2. **é¿å…åˆ¤æ–­è¯**ï¼šä¸ä½¿ç”¨ "difficult", "struggle", "problem", "useful" ç­‰è¯ï¼ˆé™¤éç”¨æˆ·å…ˆæåˆ°ï¼‰
3. **ä¸­æ€§æ¢ç´¢**ï¼šä½¿ç”¨ "tell me about", "walk me through", "describe", "what's your experience"
4. **å…·ä½“æ¡ˆä¾‹**ï¼šè¦æ±‚å…·ä½“çš„è¿‡å»è¡Œä¸ºï¼Œè€Œéå‡è®¾æˆ–æ„è§

### 2. Study Objective å¿…é—®é¡¹è¯†åˆ« ğŸ”‘

**åŠŸèƒ½**: è‡ªåŠ¨è¯†åˆ«ç ”ç©¶ç›®æ ‡ä¸­æ˜ç¡®è¦æ±‚çš„å¿…é—®é—®é¢˜æˆ–æ•°æ®æ”¶é›†é¡¹ã€‚

#### è¯†åˆ«é€»è¾‘

Prompt ä¼šåˆ†æ Research Objectiveï¼Œè¯†åˆ«ï¼š
- æ˜ç¡®è¦æ±‚çš„é—®é¢˜
- å¿…é¡»æ”¶é›†çš„æ•°æ®ç‚¹
- ç‰¹å®šçš„åŠŸèƒ½æˆ–ä¸»é¢˜éªŒè¯éœ€æ±‚
- å…³é”®çš„ç”¨æˆ·ç¾¤ä½“æˆ–åœºæ™¯

#### èå…¥ç­–ç•¥

**æˆ˜ç•¥æ€§æ”¾ç½®**:
- äººå£ç»Ÿè®¡é—®é¢˜ â†’ Session 1ï¼ˆç ´å†°ç¯èŠ‚ï¼‰
- ç‰¹å®šåŠŸèƒ½éªŒè¯ â†’ Session 3ï¼ˆæ ¸å¿ƒåŠŸèƒ½æ·±æŒ–ï¼‰
- ç«å“å¯¹æ¯” â†’ Session 5ï¼ˆç«å“å¯¹æ¯”ç¯èŠ‚ï¼‰

**æ˜ç¡®æ ‡è®°**:
```
Q3.2 [Interviewer notes: [MUST-ASK per Study Objective] This question validates
the new feature mentioned in research objective...]
Question: "Tell me about your experience with [specific feature]."
```

#### æ•ˆæœ

- âœ… ç¡®ä¿å…³é”®ç ”ç©¶ç›®æ ‡ä¸ä¼šè¢«é—æ¼
- âœ… å¿…é—®é¡¹è‡ªç„¶èå…¥è®¿è°ˆæµç¨‹
- âœ… é¢è¯•å®˜æ¸…æ¥šçŸ¥é“å“ªäº›é—®é¢˜æ˜¯å¿…é¡»é—®çš„

### 3. æ™ºèƒ½è¿½é—®ç­–ç•¥ ğŸ¯

**æ ¸å¿ƒç†å¿µ**: å…³é”®é—®é¢˜æ·±æŒ–ï¼Œä¸€èˆ¬é—®é¢˜çµæ´»ã€‚

#### A. ç¡¬ç¼–ç è¿½é—®ï¼ˆä»…ç”¨äºå…³é”®é—®é¢˜ï¼‰

**ä½¿ç”¨æ¡ä»¶**ï¼ˆå¿…é¡»åŒæ—¶æ»¡è¶³ï¼‰:
- âœ… é—®é¢˜ç›´æ¥å…³è”æ ¸å¿ƒç ”ç©¶ç›®æ ‡
- âœ… é—®é¢˜æ˜¯ Study Objective çš„å¿…é—®é¡¹
- âœ… ç¼ºå¤±è¿½é—®ä¼šå¯¼è‡´å…³é”®æ´å¯Ÿç¼ºå¤±
- âœ… è¿½é—®æ¢ç´¢çš„ç»´åº¦ä¸ä¼šè‡ªç„¶æ¶Œç°

**æ ¼å¼**:
```
**Follow-up Strategy:**
[Condition 1: If user mentions X] "Follow-up question..."
[Condition 2: If user describes Y] "Follow-up question..."
**Skip Conditions:** If context is awkward or user has already answered, skip
```

**ç¤ºä¾‹**:
```
Q3.1 [MUST-ASK] Question: "Tell me about your experience with [new feature]."

**Follow-up Strategy:**
[If user describes usage] "Can you walk me through a specific recent example?"
[If user mentions any friction] "Tell me more about that - what happened?"
**Skip Conditions:** If user has already provided detailed examples, skip follow-ups
```

#### B. å³å…´è¿½é—®ï¼ˆç”¨äºä¸€èˆ¬é—®é¢˜ï¼‰

**ä½¿ç”¨æ¡ä»¶**:
- é—®é¢˜ä¸æ˜¯æ ¸å¿ƒç ”ç©¶ç›®æ ‡çš„å…³é”®éƒ¨åˆ†
- è¿½é—®å¯ä»¥æ ¹æ®ç”¨æˆ·å›ç­”çµæ´»è°ƒæ•´
- ä¸éœ€è¦ç‰¹å®šç»´åº¦çš„æ·±æŒ–

**æ ‡è®°æ–¹å¼**:
```
Q2.3 [Interviewer notes: [Rely on impromptu follow-ups based on user response]]
Question: "What else happens in this process?"
```

**ä¼˜åŠ¿**:
- é¿å…è¿‡åº¦è„šæœ¬åŒ–
- è®¿è°ˆæ›´è‡ªç„¶ã€æ›´åƒçœŸå®å¯¹è¯
- å……åˆ†åˆ©ç”¨ Retell AI çš„å³å…´è¿½é—®èƒ½åŠ›

#### C. æ ‡å‡†å³å…´è¿½é—®æŒ‡ä»¤

æ¯ä¸ª Session éƒ½åŒ…å«æ ‡å‡†æŒ‡å¯¼ï¼š

```
**Impromptu Follow-up Guidance**:
If the user shares any new information relevant to our research goals,
conduct 1-2 follow-up questions to understand deeply (why/what/how/impact).
If irrelevant, briefly acknowledge and continue. For questions with set
follow-ups, skip if user has already answered in main response. When
acknowledging responses, vary your expressions: 'okay,' 'I see,'
'understood,' 'that makes sense,' 'got it,' 'right,' etc.
```

### 4. æœ¬åœ°åŒ–å†…å®¹æ¸…ç† ğŸ§¹

**å˜æ›´**:
- âŒ ç§»é™¤è¯¦ç»†çš„æ–‡åŒ–é€‚é…æŒ‡ä»¤
- âŒ ç§»é™¤ "Localization Reminders" ç« èŠ‚
- âœ… ç®€åŒ–è¯­è¨€é…ç½®ï¼ˆä»…ä¿ç•™åŸºæœ¬è¯­è¨€è¦æ±‚ï¼‰
- âœ… æ·»åŠ è¯´æ˜ï¼šæ–‡åŒ–é€‚é…åœ¨ç‹¬ç«‹æ­¥éª¤ä¸­å¤„ç†

**åŸå› **:
- æœ¬åœ°åŒ–åŠŸèƒ½å·²æ‹†åˆ†åˆ° `backend/src/lib/prompts/localize-outline.ts`
- å¤§çº²ç”Ÿæˆèšç„¦å†…å®¹è´¨é‡ï¼Œæœ¬åœ°åŒ–èšç„¦æ–‡åŒ–é€‚é…
- èŒè´£åˆ†ç¦»ï¼Œæå‡å„è‡ªè´¨é‡

### 5. å¸‚åœºè°ƒç ”ç‰¹å®šä¼˜åŒ–

#### ç—›ç‚¹å‘ç°ï¼ˆè€Œéå‡è®¾ï¼‰

**æ—§æ–¹æ³•**ï¼ˆå‡è®¾ç—›ç‚¹å­˜åœ¨ï¼‰:
```
âŒ "What frustrates you the most when dealing with [scenario]?"
```

**æ–°æ–¹æ³•**ï¼ˆè®©ç—›ç‚¹è‡ªç„¶æ¶Œç°ï¼‰:
```
âœ… "Tell me about your current process for [scenario]."
â†’ [If user mentions friction] "Tell me more about that - what happened?"
```

#### ç†æƒ³è§£å†³æ–¹æ¡ˆæ¢ç´¢

**æ—§æ–¹æ³•**ï¼ˆç›´æ¥é—®åŠŸèƒ½éœ€æ±‚ï¼‰:
```
âŒ "What features would you like to see?"
```

**æ–°æ–¹æ³•**ï¼ˆæ¢ç´¢ç†æƒ³çŠ¶æ€ï¼‰:
```
âœ… "If you could wave a magic wand, how would this process work ideally?"
â†’ "What's most important in that ideal scenario?"
```

### 6. äº§å“è°ƒç ”ç‰¹å®šä¼˜åŒ–

#### åŠŸèƒ½å‘ç°ï¼ˆè€Œéå‡è®¾ï¼‰

**æ—§æ–¹æ³•**ï¼ˆå‡è®¾ç”¨æˆ·å·²å‘ç°åŠŸèƒ½ï¼‰:
```
âŒ "How useful is [Feature]?"
```

**æ–°æ–¹æ³•**ï¼ˆæ¢ç´¢å®é™…ä½¿ç”¨ï¼‰:
```
âœ… "Tell me about your experience using [Product]."
â†’ [If user mentions feature] "How did you first come across this feature?"
â†’ "What's your understanding of what it does?"
â†’ "How often do you use it? In what situations?"
```

#### ç«å“å¯¹æ¯”ç­–ç•¥

**æ—§æ–¹æ³•**ï¼ˆç›´æ¥é—®ç«å“ï¼‰:
```
âŒ "Which competitors have you used?"
```

**æ–°æ–¹æ³•**ï¼ˆè‡ªç„¶å¼•å‡ºå¯¹æ¯”ï¼‰:
```
âœ… "Before using [Product], what tools or methods did you use for [task]?"
â†’ [If they mention alternatives] "What's different about your experience
   with [Product] compared to [Alternative]?"
```

### ä¼˜åŒ–æ•ˆæœ

**è´¨é‡æå‡**:
- âœ… ç”Ÿæˆçš„é—®é¢˜æ›´åŠ å¼€æ”¾ã€æ— åè§
- âœ… å‡å°‘å¼•å¯¼æ€§é—®é¢˜å¯¼è‡´çš„æ•°æ®åå·®
- âœ… è®¿è°ˆæµç¨‹æ›´è‡ªç„¶ã€æ›´åƒçœŸå®å¯¹è¯

**ç›®æ ‡è¾¾æˆ**:
- âœ… å…³é”®ç ”ç©¶ç›®æ ‡çš„å¿…é—®é¡¹ä¸ä¼šé—æ¼
- âœ… æ ¸å¿ƒé—®é¢˜å¾—åˆ°æ·±åº¦æŒ–æ˜
- âœ… ä¸€èˆ¬é—®é¢˜ä¿æŒçµæ´»æ€§

**ç”¨æˆ·ä½“éªŒ**:
- âœ… å‚ä¸è€…æ„Ÿè§‰æ›´èˆ’é€‚ï¼Œæ„¿æ„åˆ†äº«çœŸå®ä½“éªŒ
- âœ… é¢è¯•å®˜æœ‰æ¸…æ™°çš„æŒ‡å¯¼ï¼ŒçŸ¥é“ä½•æ—¶æ·±æŒ–ã€ä½•æ—¶çµæ´»
- âœ… è®¿è°ˆèŠ‚å¥æ›´è‡ªç„¶ï¼Œä¸ä¼šæ„Ÿè§‰æœºæ¢°

### å½±å“çš„æ–‡ä»¶

- `backend/src/lib/prompts/generate-market-research-sessions.ts` (248 lines â†’ 279 lines)
- `backend/src/lib/prompts/generate-product-research-sessions.ts` (241 lines â†’ 274 lines)

---

## ğŸ¯ è¿½é—®ç”Ÿæˆé€»è¾‘ä¼˜åŒ– (v1.3.8)

### ä¼˜åŒ–ç›®æ ‡

è¿›ä¸€æ­¥ä¼˜åŒ–è¿½é—®ç”Ÿæˆé€»è¾‘ï¼Œä½¿è®¿è°ˆæ‰§è¡Œæ›´çµæ´»ã€æ›´è‡ªç„¶ï¼š

1. **ç§»é™¤å³å…´è¿½é—®ç›¸å…³å†…å®¹**ï¼ˆç³»ç»Ÿè‡ªåŠ¨å¤„ç†ï¼‰
2. **è¿½é—®æ”¹ä¸ºæ–¹å‘æ€§æŒ‡ç¤º**ï¼ˆè€Œéå›ºå®šå¥å­ï¼‰
3. **Session æ¡ˆä¾‹æŠ½è±¡åŒ–**ï¼ˆé¿å…è¿‡åº¦å…·è±¡ï¼‰
4. **åˆ é™¤è¿‡æ‹Ÿåˆè§„åˆ™**ï¼ˆå¦‚ AI collectionï¼‰

### æ ¸å¿ƒå˜æ›´

#### 1. ç§»é™¤å³å…´è¿½é—®æŒ‡å¯¼ ğŸ§¹

**åˆ é™¤å†…å®¹**:
- âŒ "Standard Impromptu Instructions" ç« èŠ‚
- âŒ "Impromptu Follow-up Guidance" å†…å®¹

**åŸå› **: è®¿è°ˆæ‰§è¡Œç³»ç»Ÿï¼ˆRetell AIï¼‰å·²å†…ç½®å³å…´è¿½é—®èƒ½åŠ›ï¼Œåœ¨å¤§çº²ç”Ÿæˆé˜¶æ®µé‡å¤æŒ‡å¯¼æ˜¯å†—ä½™çš„ã€‚

#### 2. è¿½é—®æ”¹ä¸ºæ–¹å‘æ€§æŒ‡ç¤º ğŸ¯

**æ—§æ ¼å¼**ï¼ˆå›ºå®šå¥å­ï¼‰:
```
[If user mentions friction] "Can you tell me more? What happened?"
```

**æ–°æ ¼å¼**ï¼ˆæ–¹å‘æ€§æŒ‡ç¤ºï¼‰:
```
[If user mentions friction] â†’ Probe for: specific examples, impact, solutions
```

**ä¼˜åŠ¿**: Agent å¯æ ¹æ®è¯­å¢ƒçµæ´»æªè¾ï¼Œè®¿è°ˆæ›´è‡ªç„¶ã€‚

#### 3. Session æ¡ˆä¾‹æŠ½è±¡åŒ– ğŸ“‹

**æ—§æ ¼å¼**ï¼ˆè¿‡äºå…·è±¡ï¼‰:
```
- Session 1: Ice-breaking + Current behavior
- Session 2: Pain points deep dive
- Session 5: AI/Technology expectations
```

**æ–°æ ¼å¼**ï¼ˆæŠ½è±¡åŸåˆ™ï¼‰:
```
Session Flow: Intro â†’ Open Exploration â†’ Targeted Collection â†’ Closure
Session Themes: Early (context) â†’ Middle (deep dive) â†’ Later (synthesis)
```

#### 4. åˆ é™¤è¿‡æ‹Ÿåˆè§„åˆ™ ğŸ§¹

**åˆ é™¤**: "AI/Technology Expectations" ç« èŠ‚ï¼ˆé€†å‘å·¥ç¨‹æ—¶è¿‡æ‹Ÿåˆçš„ç‰¹å®šæ¡ˆä¾‹ï¼‰

### ä¼˜åŒ–æ•ˆæœ

- âœ… è®¿è°ˆæ›´çµæ´»ã€æ›´è‡ªç„¶
- âœ… å¤§çº²æ›´é€‚é…å…·ä½“ç ”ç©¶ç›®æ ‡
- âœ… èŒè´£åˆ†ç¦»ï¼šå¤§çº²èšç„¦å…³é”®é—®é¢˜ï¼Œæ‰§è¡Œèšç„¦çµæ´»æªè¾

### å½±å“çš„æ–‡ä»¶

- `backend/src/lib/prompts/generate-market-research-sessions.ts` (279 lines â†’ 272 lines)
- `backend/src/lib/prompts/generate-product-research-sessions.ts` (279 lines â†’ 272 lines)

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Session Depth Level å®Œæ•´å®ç°æ€»ç»“](./Session-Depth-Level-å®Œæ•´å®ç°æ€»ç»“.md)
- [å¤§çº²æœ¬åœ°åŒ–åŠŸèƒ½](./04-å¤§çº²æœ¬åœ°åŒ–åŠŸèƒ½.md)
- [è®¿è°ˆæ‰§è¡Œ - Retell AI è¯­éŸ³äº¤äº’](./05-è®¿è°ˆæ‰§è¡Œ-Retell AIè¯­éŸ³äº¤äº’.md)
- [æŠ€æœ¯æ¶æ„](./01-æŠ€æœ¯æ¶æ„.md)
- [æ•°æ®åº“è®¾è®¡](./02-æ•°æ®åº“è®¾è®¡.md)
- [CHANGELOG](./CHANGELOG.md)

---

## ğŸ“ å­¦ä¹ èµ„æº

### æ¨èé˜…è¯»

1. **ç”¨æˆ·ç ”ç©¶æ–¹æ³•è®º**:
   - [The Mom Test](http://momtestbook.com/) - å¦‚ä½•é—®å‡ºçœŸå®ç­”æ¡ˆ
   - [Just Enough Research](https://abookapart.com/products/just-enough-research) - ç”¨æˆ·ç ”ç©¶åŸºç¡€

2. **è®¿è°ˆæŠ€å·§**:
   - [Interviewing Users](https://rosenfeldmedia.com/books/interviewing-users/) - è®¿è°ˆç”¨æˆ·æŒ‡å—
   - [The User Interview](https://www.nngroup.com/articles/user-interviews/) - Nielsen Norman Group

3. **Prompt å·¥ç¨‹**:
   - [OpenAI Prompt Engineering Guide](https://platform.openai.com/docs/guides/prompt-engineering)
   - [Anthropic Prompt Engineering](https://docs.anthropic.com/claude/docs/prompt-engineering)

### å†…éƒ¨æ–‡æ¡£

- [Augment-Memories.md](./Augment-Memories.md) - é¡¹ç›®æ ¸å¿ƒè®°å¿†
- [ä»»åŠ¡æ¸…å•.md](./ä»»åŠ¡æ¸…å•.md) - å½“å‰ä»»åŠ¡è·Ÿè¸ª

---

**ç»´æŠ¤è€…**: Userology å¼€å‘å›¢é˜Ÿ
**æœ€åæ›´æ–°**: 2025-10-31
**ç‰ˆæœ¬**: 1.4.5

